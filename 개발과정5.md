# To do

 6/30일까지 기본 기능 모두 완성

 7/12 최종 UI까지 모두 완성 목표!! ( 7/9가 레알 목표 )



### [account 관련] - 6/24

1. 회원정보 최종 Model - 완료
2.  친구 / 그룹 관련 Model 작성 - 완료

 --------------------------------------------------------------------------------------------------- 6/24 (+ invitations Model - 완료

* UI

1. **회원정보 수정 페이지 - 디자인 / 개발** 
2. 친구 관리 페이지 - 디자인 - 완료(6/28) / 개발



### [Event 관련]

1. invitation 보내기 (친구, 그룹 선택 ) ------------------ (디자인 6/29 , 개발 7/2)

   * invitation Table ----------------6/24 -완료

   * 보내기 UI -----------------------------------7/2 

     

2. My Events 관리 페이지 -------------7/2 

 --------------------------------------------------------------------------------------------------- 6/30 ( 디자인 -- 6/29 개발 -- 7/2 )



### [UI]

1. events 달력 표시
2. Event 상세 페이지
   - Event 댓글 기능

 --------------------------------------------------------------------------------------------------- 7/12





# 회원, 친구 관리

## 카카오 계정 참고

https://developers.kakao.com/docs/latest/ko/user-mgmt/common

kakao_account에 담긴 사용자 정보 종류

| Name                                                         | Type   | Description             |
| :----------------------------------------------------------- | :----- | :---------------------- |
| [프로필(profile)](https://developers.kakao.com/docs/latest/ko/user-mgmt/common#profile) | JSON   | 카카오계정 프로필 정보  |
| [이메일(email)](https://developers.kakao.com/docs/latest/ko/user-mgmt/common#email) | String | 카카오계정 대표 이메일  |
| [연령대(age_range)](https://developers.kakao.com/docs/latest/ko/user-mgmt/common#age-range) | String | 연령대, 하단 상세 참고  |
| [생일(birthday)](https://developers.kakao.com/docs/latest/ko/user-mgmt/common#birthday) | String | 생일, MMDD 형식         |
| [출생 연도(birthyear)](https://developers.kakao.com/docs/latest/ko/user-mgmt/common#birthyear) | String | 태어난 해, YYYY 형식    |
| [성별(gender)](https://developers.kakao.com/docs/latest/ko/user-mgmt/common#gender) | String | 성별, female/male       |
| [전화번호(phone_number)](https://developers.kakao.com/docs/latest/ko/user-mgmt/common#phone-number) | String | 전화번호                |
| [연계정보(ci)](https://developers.kakao.com/docs/latest/ko/user-mgmt/common#ci) | String | 암호화된 이용자 확인 값 |









## 친구/그룹관리

![fg_modeling](https://github.com/arara90/images/blob/master/Simtime/simtime_031.png?raw=true)

* Friend 모델에서 account_id(user)가 friend_id를 관리한다. 
* Group 모델에서는 user별로 어떤 그룹을 갖을 것인지 관리한다.  
* WhichGroup은 friend가 어디에 속할 것인지를 관리한다. (단, 한 친구는 여러 그룹에 속할 수 있다.)







[?]

id를 따로 만들어서 PK를 주는 것과, 여러키로 PK를 구성하는 것의 차이? 

- FK조합으로 PK를 만드는 다대다 관계 테이블.
- id를 따로 만들어 PK를 만드는 것의 장점?



#### [읽어보기]

[Facebook Style Friend Request System Database Design](https://www.9lessons.info/2014/03/facebook-style-friend-request-system.html)

- 해당 글을 참고하려 했으나, 페이스북과 같은 친구 관계를 맺기 위해서 추가로 개발해야 하는 (친구 요청 관련) 사항이 많아져 PASS.





![fg_modeling](https://github.com/arara90/images/blob/master/Simtime/simtime_032.png?raw=true)





## django에서 다대다 관계 테이블 만들때, 복합키를 만들 수 없다.

https://stackoverflow.com/questions/2270808/compound-composite-primary-unique-key-with-django/10139474



대안 ) Meta Class의 unique_together를 사용해서, 두 필드 조합이 unique하게 제약조건을 줄 수 있다. 

```python
class Relationship(models.Model):
    account = models.ForeignKey(
        settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name='friends')
    friend = models.ForeignKey(
        settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name='friendOf')
    # friends can block the user. (=수신동의)
    is_blocked = models.BooleanField(null=False, default=False)
    # Status = 0;본인 1;request 2.confirm 3; A blocks B 4;B blocks A 5; block each others.

    class Meta:
        unique_together = ('account_id', 'friend_id')
```







## JsonField()

https://docs.djangoproject.com/en/3.0/ref/contrib/postgres/fields/#django.contrib.postgres.fields.JSONField

: JsonField PostgreSQL specific model fields

All of these fields are available from the `django.contrib.postgres.fields` module.



즉, ArrayField처럼 postgres 맞춤형 필드로 import해줘야 한다. 비교적 최근에서야 DB들이 Json형을 지원하기 시작했기때문에, 통합된 형태로 지원되지 않는 것 같다. 사용하고 있는 DB가 라이브러리를 통해 (ex. [mysql의 경우](https://django-mysql.readthedocs.io/en/latest/model_fields/json_field.html)는 from django_mysql.models import JSONField, Model) Jsonfield를 지원하는지 확인해야한다.







## Meta Change 시 No migrations to apply.

django  how to apply meta changes...